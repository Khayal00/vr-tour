<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>VR Tour with Hotspot Labels</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/protyze/aframe-look-at-component/master/dist/aframe-look-at-component.min.js"></script>
    <style>
      body { margin: 0; }
    </style>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <img id="scene1" src="living_room.jpg">
        <img id="scene2" src="kitchen.jpg">
        <audio id="clickSound" src="click.mp3"></audio>
      </a-assets>

      <!-- الكاميرا -->
      <a-entity id="camera" camera look-controls position="0 1.6 0" raycaster="objects: .hotspot" cursor="fuse: false; rayOrigin: mouse"></a-entity>

      <!-- صورة المشهد -->
      <a-sky id="sky" src="#scene1" rotation="0 -90 0"></a-sky>

      <!-- حاوية النقاط -->
      <a-entity id="hotspotContainer"></a-entity>
    </a-scene>

    <script>
      const scenes = {
        scene1: {
          img: '#scene1',
          hotspots: [
            { position: '1 1 -3', target: 'Kitchen' }
          ]
        },
        scene2: {
          img: '#scene2',
          hotspots: [
            { position: '-2 1 -3', target: 'Living Room' }
          ]
        }
      };

      const sky = document.querySelector('#sky');
      const hotspotContainer = document.querySelector('#hotspotContainer');
      const audio = document.querySelector('#clickSound');

      function changeScene(sceneName) {
        const scene = scenes[sceneName];
        sky.setAttribute('src', scene.img);
        hotspotContainer.innerHTML = '';

        scene.hotspots.forEach(hs => {
          const hotspotEntity = document.createElement('a-entity');
          hotspotEntity.setAttribute('position', hs.position);

          // الكرة
          const sphere = document.createElement('a-sphere');
          sphere.setAttribute('class', 'hotspot');
          sphere.setAttribute('radius', 0.12);
          sphere.setAttribute('color', '#FFFFFF');
          sphere.setAttribute('material', 'shader: standard; emissive: #FFD700; emissiveIntensity: 0.0');
          hotspotEntity.appendChild(sphere);

          // حلقة التوهج
          const ring = document.createElement('a-ring');
          ring.setAttribute('position', '0 0 0');
          ring.setAttribute('rotation', '-90 0 0');
          ring.setAttribute('radius-inner', 0.25);
          ring.setAttribute('radius-outer', 1);
          ring.setAttribute('material', 'color: #FFD700; shader: flat; opacity: 0.5; transparent: true');
          hotspotEntity.appendChild(ring);

          // النص
          const label = document.createElement('a-text');
          label.setAttribute('value', hs.target);
          label.setAttribute('align', 'center');
          label.setAttribute('color', '#FFF');
          label.setAttribute('width', 3);
          label.setAttribute('visible', 'false');
          label.setAttribute('position', `0 0.5 0`);
          label.setAttribute('look-at', '#camera');
          hotspotEntity.appendChild(label);

          // الأحداث
          sphere.addEventListener('mouseenter', () => {
            label.setAttribute('visible', 'true');
            sphere.setAttribute('scale', '1.2 1.2 1.2');
            sphere.setAttribute('material', 'emissiveIntensity: 1');
            ring.setAttribute('scale', '1.5 1.5 1.5');
          });

          sphere.addEventListener('mouseleave', () => {
            label.setAttribute('visible', 'false');
            sphere.setAttribute('scale', '1 1 1');
            sphere.setAttribute('material', 'emissiveIntensity: 0');
            ring.setAttribute('scale', '1 1 1');
          });

          sphere.addEventListener('click', () => {
            audio.pause();
            audio.currentTime = 0;
            audio.play().catch(() => {});
            changeScene(hs.target === 'Kitchen' ? 'scene2' : 'scene1');
          });

          hotspotContainer.appendChild(hotspotEntity);
        });
      }

      changeScene('scene1');
    </script>
  </body>
</html>
